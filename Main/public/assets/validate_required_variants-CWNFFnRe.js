import{R as g,j as b,t as N}from"./app-DV9Enp-g.js";import{H as D,A as w}from"./platform_roles-C6HFwJ_S.js";import{a as v,I as A}from"./input-BY0aN3Wh.js";import{M as J}from"./Minus-hQCtIxHU.js";function $({value:s,defaultValue:i=1,onValueChange:t,disabled:n=!1,incrementButtonClassName:e="",decrementButtonClassName:o="",containerClassName:r="",className:l}){const[a,c]=g.useState(i),f=m=>{c(m+1),t==null||t(m+1)},d=m=>{m>1?(c(m-1),t==null||t(m-1)):(c(1),t==null||t(1))},p=g.useMemo(()=>s,[s]);return g.useEffect(()=>{p&&c(p)},[p]),b.jsxDEV(D,{gap:0,align:"center",className:r,children:[b.jsxDEV(v,{"aria-label":"quantityDecrementButton",type:"button",colorScheme:"red",size:"sm",className:`${o} w-8 h-8`,onClick:()=>d(a),disabled:n||a<=1,children:b.jsxDEV(J,{size:16},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/common/QuantityController.tsx",lineNumber:65,columnNumber:9},this)},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/common/QuantityController.tsx",lineNumber:56,columnNumber:7},this),b.jsxDEV(A,{type:"number",value:a,onChange:m=>{const I=parseInt(m.target.value);I>0&&(c(I),t==null||t(I))},textAlign:"center",width:"40px",size:"sm",border:"none",disabled:n,onFocus:m=>m.target.select(),className:l},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/common/QuantityController.tsx",lineNumber:67,columnNumber:7},this),b.jsxDEV(v,{"aria-label":"quantityIncrementButton",type:"button",colorScheme:"green",size:"sm",className:`${e} w-8 h-8`,disabled:n,onClick:()=>f(a),children:b.jsxDEV(w,{size:16},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/common/QuantityController.tsx",lineNumber:94,columnNumber:9},this)},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/common/QuantityController.tsx",lineNumber:85,columnNumber:7},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/common/QuantityController.tsx",lineNumber:55,columnNumber:5},this)}const L=(s,i,t)=>s<=0?0:t==="amount"?s-i:s-s*i*.01,E=s=>{let i;const t=new Set,n=(c,f)=>{const d=typeof c=="function"?c(i):c;if(!Object.is(d,i)){const p=i;i=f??(typeof d!="object"||d===null)?d:Object.assign({},i,d),t.forEach(m=>m(i,p))}},e=()=>i,l={setState:n,getState:e,getInitialState:()=>a,subscribe:c=>(t.add(c),()=>t.delete(c))},a=i=s(n,e,l);return l},_=s=>s?E(s):E,H=s=>s;function Q(s,i=H){const t=g.useSyncExternalStore(s.subscribe,()=>i(s.getState()),()=>i(s.getInitialState()));return g.useDebugValue(t),t}const j=s=>{const i=_(s),t=n=>Q(i,n);return Object.assign(t,i),t},R=s=>s?j(s):j;function q(s,i){let t;try{t=s()}catch{return}return{getItem:e=>{var o;const r=a=>a===null?null:JSON.parse(a,void 0),l=(o=t.getItem(e))!=null?o:null;return l instanceof Promise?l.then(r):r(l)},setItem:(e,o)=>t.setItem(e,JSON.stringify(o,void 0)),removeItem:e=>t.removeItem(e)}}const x=s=>i=>{try{const t=s(i);return t instanceof Promise?t:{then(n){return x(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return x(n)(t)}}}},k=(s,i)=>(t,n,e)=>{let o={storage:q(()=>localStorage),partialize:u=>u,version:0,merge:(u,h)=>({...h,...u}),...i},r=!1;const l=new Set,a=new Set;let c=o.storage;if(!c)return s((...u)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),t(...u)},n,e);const f=()=>{const u=o.partialize({...n()});return c.setItem(o.name,{state:u,version:o.version})},d=e.setState;e.setState=(u,h)=>{d(u,h),f()};const p=s((...u)=>{t(...u),f()},n,e);e.getInitialState=()=>p;let m;const I=()=>{var u,h;if(!c)return;r=!1,l.forEach(S=>{var y;return S((y=n())!=null?y:p)});const O=((h=o.onRehydrateStorage)==null?void 0:h.call(o,(u=n())!=null?u:p))||void 0;return x(c.getItem.bind(c))(o.name).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==o.version){if(o.migrate){const y=o.migrate(S.state,S.version);return y instanceof Promise?y.then(P=>[!0,P]):[!0,y]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,S.state];return[!1,void 0]}).then(S=>{var y;const[P,T]=S;if(m=o.merge(T,(y=n())!=null?y:p),t(m,!0),P)return f()}).then(()=>{O==null||O(m,void 0),m=n(),r=!0,a.forEach(S=>S(m))}).catch(S=>{O==null||O(void 0,S)})};return e.persist={setOptions:u=>{o={...o,...u},u.storage&&(c=u.storage)},clearStorage:()=>{c==null||c.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>I(),hasHydrated:()=>r,onHydrate:u=>(l.add(u),()=>{l.delete(u)}),onFinishHydration:u=>(a.add(u),()=>{a.delete(u)})},o.skipHydration||I(),m||p},F=k,U=R()(F((s,i)=>({customer:null,type:"dine_in",paymentType:"cash",subTotal:0,discount:0,total:0,note:"",POSItems:[],POSCharges:[],setNote:t=>s({note:t}),changeType:(t,n)=>{s(t==="delivery"?e=>({type:t,POSCharges:[...e.POSCharges,{id:999,type:"delivery",name:"Delivery Charge",amount:n,amountType:"amount",isAvailable:1}]}):{type:t,POSCharges:[]}),i().calculate()},changePaymentType:t=>s({paymentType:t}),setDiscount:(t,n)=>{let e=0;n==="percentage"?e=t/100*i().subTotal:e=t,s({discount:e}),i().calculate()},setCustomer:t=>s({customer:t}),addItemToPOS:t=>{s(n=>{let e=[...n.POSItems];const o=e.findIndex(r=>JSON.stringify(r)===JSON.stringify(t));return o!==-1?(e[o].quantity+=1,e[o].total=n.POSItems[o].quantity*n.POSItems[o].subTotal,{POSItems:e}):(e=[...n.POSItems,t],{POSItems:e})}),i().calculate()},selectAddon:(t,n,e)=>{const o=n.findIndex(l=>l.id===t.id);let r=[...n];o===-1?r=[...n,{...t,quantity:1}]:r=r.filter(l=>l.id!==t.id),e(r)},selectVariant:(t,n,e,o)=>{var a;const r=e.findIndex(c=>c.id===t.id);let l=[...e];n==="radio"?r===-1?l=[...e,{...t,option:[t.option]}]:l[r]={...t,option:[t.option]}:r===-1?l=[...e,t]:l[r].option.findIndex(f=>{var d;return f.id===((d=t.option)==null?void 0:d[0].id)})===-1?l[r].option.push((a=t.option)==null?void 0:a[0]):l[r].option=l[r].option.filter(f=>{var d;return f.id!==((d=t.option)==null?void 0:d[0].id)}),o(l)},setAddonQty:(t,n,e,o)=>{const r=e.findIndex(a=>a.id===t);let l=[...e];r!==-1&&(l[r].quantity=n),o(l)},updateItemInPOS:t=>{s(n=>{const e=n.POSItems.map(o=>o.id===t.id?t:o);return{...n,POSItems:e}}),i().calculate()},removeItemFromPOS:t=>{s(n=>({POSItems:n.POSItems.filter(o=>JSON.stringify(o)!==JSON.stringify(t))})),i().calculate()},setQuantity:(t,n)=>{s(e=>({POSItems:e.POSItems.map(r=>(JSON.stringify(r)===JSON.stringify(t)&&(r.quantity=n,r.total=r.quantity*r.subTotal),r))})),i().calculate()},calculate:()=>{s(t=>{const n=t.POSItems.reduce((a,c)=>a+c.total,0),e=[],o=t.POSCharges.find(a=>a.id===999);o&&e.push(o),t.POSItems.forEach(a=>{a.charges&&a.charges.forEach(c=>{let f=0;if(c.amountType==="percentage"){const p=c.amount/100*a.total;f+=p}else f+=c.amount*a.quantity;const d=e.findIndex(p=>p.id===c.id);d===-1?e.push({...c,amount:f}):e[d].amount+=f})});const r=e.reduce((a,c)=>a+c.amount,0),l=n+r-t.discount;return{subTotal:n,total:l,POSCharges:e}})},resetPOS:()=>s({POSItems:[],POSCharges:[],subTotal:0,discount:0,total:0,note:"",customer:null,type:"dine_in",paymentType:"cash"})}),{name:"pos-storage",storage:q(()=>localStorage)})),G=(s,i,t)=>{const n=[],e=s==null?void 0:s.filter(o=>o.requirement==="required");return e!=null&&e.length&&e.forEach(o=>{const l=(i==null?void 0:i.map(a=>({id:a.id,option:a.option}))).find(a=>a.id===o.id&&a.option.length!==0);o.allowMultiple&&l&&l.option.length<o.min?(N.error(t("Please select all required variants.")),n.push(t("Please select all required variants."))):l||(N.error(t("Please select all required variants.")),n.push(t("Please select all required variants.")))}),n};export{$ as Q,L as c,U as u,G as v};
