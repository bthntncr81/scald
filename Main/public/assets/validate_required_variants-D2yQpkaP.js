import{R as O,j as b,t as N}from"./app-p3FobzL5.js";import{H as j,A as k}from"./platform_roles-D3HjcMuK.js";import{a as v,I as w}from"./input-cx0LjzCS.js";import{M as A}from"./Minus-CX-dPmlg.js";function z({value:s,defaultValue:i=1,onValueChange:t,disabled:n=!1,incrementButtonClassName:e="",decrementButtonClassName:o="",containerClassName:r="",className:l}){const[a,c]=O.useState(i),f=m=>{c(m+1),t==null||t(m+1)},d=m=>{m>1?(c(m-1),t==null||t(m-1)):(c(1),t==null||t(1))},p=O.useMemo(()=>s,[s]);return O.useEffect(()=>{p&&c(p)},[p]),b.jsxDEV(j,{gap:0,align:"center",className:r,children:[b.jsxDEV(v,{"aria-label":"quantityDecrementButton",type:"button",colorScheme:"red",size:"sm",className:`${o} w-8 h-8`,onClick:()=>d(a),disabled:n||a<=1,children:b.jsxDEV(A,{size:16},void 0,!1,{fileName:"/Users/omerbatuhantuncer/Desktop/resto/source/inertia/components/common/QuantityController.tsx",lineNumber:65,columnNumber:9},this)},void 0,!1,{fileName:"/Users/omerbatuhantuncer/Desktop/resto/source/inertia/components/common/QuantityController.tsx",lineNumber:56,columnNumber:7},this),b.jsxDEV(w,{type:"number",value:a,onChange:m=>{const h=parseInt(m.target.value);h>0&&(c(h),t==null||t(h))},textAlign:"center",width:"40px",size:"sm",border:"none",disabled:n,onFocus:m=>m.target.select(),className:l},void 0,!1,{fileName:"/Users/omerbatuhantuncer/Desktop/resto/source/inertia/components/common/QuantityController.tsx",lineNumber:67,columnNumber:7},this),b.jsxDEV(v,{"aria-label":"quantityIncrementButton",type:"button",colorScheme:"green",size:"sm",className:`${e} w-8 h-8`,disabled:n,onClick:()=>f(a),children:b.jsxDEV(k,{size:16},void 0,!1,{fileName:"/Users/omerbatuhantuncer/Desktop/resto/source/inertia/components/common/QuantityController.tsx",lineNumber:94,columnNumber:9},this)},void 0,!1,{fileName:"/Users/omerbatuhantuncer/Desktop/resto/source/inertia/components/common/QuantityController.tsx",lineNumber:85,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/omerbatuhantuncer/Desktop/resto/source/inertia/components/common/QuantityController.tsx",lineNumber:55,columnNumber:5},this)}const $=(s,i,t)=>s<=0?0:t==="amount"?s-i:s-s*i*.01,D=s=>{let i;const t=new Set,n=(c,f)=>{const d=typeof c=="function"?c(i):c;if(!Object.is(d,i)){const p=i;i=f??(typeof d!="object"||d===null)?d:Object.assign({},i,d),t.forEach(m=>m(i,p))}},e=()=>i,l={setState:n,getState:e,getInitialState:()=>a,subscribe:c=>(t.add(c),()=>t.delete(c))},a=i=s(n,e,l);return l},J=s=>s?D(s):D,_=s=>s;function H(s,i=_){const t=O.useSyncExternalStore(s.subscribe,()=>i(s.getState()),()=>i(s.getInitialState()));return O.useDebugValue(t),t}const q=s=>{const i=J(s),t=n=>H(i,n);return Object.assign(t,i),t},Q=s=>s?q(s):q;function E(s,i){let t;try{t=s()}catch{return}return{getItem:e=>{var o;const r=a=>a===null?null:JSON.parse(a,void 0),l=(o=t.getItem(e))!=null?o:null;return l instanceof Promise?l.then(r):r(l)},setItem:(e,o)=>t.setItem(e,JSON.stringify(o,void 0)),removeItem:e=>t.removeItem(e)}}const x=s=>i=>{try{const t=s(i);return t instanceof Promise?t:{then(n){return x(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return x(n)(t)}}}},R=(s,i)=>(t,n,e)=>{let o={storage:E(()=>localStorage),partialize:u=>u,version:0,merge:(u,I)=>({...I,...u}),...i},r=!1;const l=new Set,a=new Set;let c=o.storage;if(!c)return s((...u)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),t(...u)},n,e);const f=()=>{const u=o.partialize({...n()});return c.setItem(o.name,{state:u,version:o.version})},d=e.setState;e.setState=(u,I)=>{d(u,I),f()};const p=s((...u)=>{t(...u),f()},n,e);e.getInitialState=()=>p;let m;const h=()=>{var u,I;if(!c)return;r=!1,l.forEach(S=>{var y;return S((y=n())!=null?y:p)});const P=((I=o.onRehydrateStorage)==null?void 0:I.call(o,(u=n())!=null?u:p))||void 0;return x(c.getItem.bind(c))(o.name).then(S=>{if(S)if(typeof S.version=="number"&&S.version!==o.version){if(o.migrate){const y=o.migrate(S.state,S.version);return y instanceof Promise?y.then(g=>[!0,g]):[!0,y]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,S.state];return[!1,void 0]}).then(S=>{var y;const[g,T]=S;if(m=o.merge(T,(y=n())!=null?y:p),t(m,!0),g)return f()}).then(()=>{P==null||P(m,void 0),m=n(),r=!0,a.forEach(S=>S(m))}).catch(S=>{P==null||P(void 0,S)})};return e.persist={setOptions:u=>{o={...o,...u},u.storage&&(c=u.storage)},clearStorage:()=>{c==null||c.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>h(),hasHydrated:()=>r,onHydrate:u=>(l.add(u),()=>{l.delete(u)}),onFinishHydration:u=>(a.add(u),()=>{a.delete(u)})},o.skipHydration||h(),m||p},U=R,L=Q()(U((s,i)=>({customer:null,type:"dine_in",paymentType:"cash",subTotal:0,discount:0,total:0,note:"",POSItems:[],POSCharges:[],setNote:t=>s({note:t}),changeType:(t,n)=>{s(t==="delivery"?e=>({type:t,POSCharges:[...e.POSCharges,{id:999,type:"delivery",name:"Delivery Charge",amount:n,amountType:"amount",isAvailable:1}]}):{type:t,POSCharges:[]}),i().calculate()},changePaymentType:t=>s({paymentType:t}),setDiscount:(t,n)=>{let e=0;n==="percentage"?e=t/100*i().subTotal:e=t,s({discount:e}),i().calculate()},setCustomer:t=>s({customer:t}),addItemToPOS:t=>{s(n=>{let e=[...n.POSItems];const o=e.findIndex(r=>JSON.stringify(r)===JSON.stringify(t));return o!==-1?(e[o].quantity+=1,e[o].total=n.POSItems[o].quantity*n.POSItems[o].subTotal,{POSItems:e}):(e=[...n.POSItems,t],{POSItems:e})}),i().calculate()},selectAddon:(t,n,e)=>{const o=n.findIndex(l=>l.id===t.id);let r=[...n];o===-1?r=[...n,{...t,quantity:1}]:r=r.filter(l=>l.id!==t.id),e(r)},selectVariant:(t,n,e,o)=>{var a;const r=e.findIndex(c=>c.id===t.id);let l=[...e];n==="radio"?r===-1?l=[...e,{...t,option:[t.option]}]:l[r]={...t,option:[t.option]}:r===-1?l=[...e,t]:l[r].option.findIndex(f=>{var d;return f.id===((d=t.option)==null?void 0:d[0].id)})===-1?l[r].option.push((a=t.option)==null?void 0:a[0]):l[r].option=l[r].option.filter(f=>{var d;return f.id!==((d=t.option)==null?void 0:d[0].id)}),o(l)},setAddonQty:(t,n,e,o)=>{const r=e.findIndex(a=>a.id===t);let l=[...e];r!==-1&&(l[r].quantity=n),o(l)},updateItemInPOS:t=>{s(n=>{const e=n.POSItems.map(o=>o.id===t.id?t:o);return{...n,POSItems:e}}),i().calculate()},removeItemFromPOS:t=>{s(n=>({POSItems:n.POSItems.filter(o=>JSON.stringify(o)!==JSON.stringify(t))})),i().calculate()},setQuantity:(t,n)=>{s(e=>({POSItems:e.POSItems.map(r=>(JSON.stringify(r)===JSON.stringify(t)&&(r.quantity=n,r.total=r.quantity*r.subTotal),r))})),i().calculate()},calculate:()=>{s(t=>{const n=t.POSItems.reduce((a,c)=>a+c.total,0),e=[],o=t.POSCharges.find(a=>a.id===999);o&&e.push(o),t.POSItems.forEach(a=>{a.charges&&a.charges.forEach(c=>{let f=0;if(c.amountType==="percentage"){const p=c.amount/100*a.total;f+=p}else f+=c.amount*a.quantity;const d=e.findIndex(p=>p.id===c.id);d===-1?e.push({...c,amount:f}):e[d].amount+=f})});const r=e.reduce((a,c)=>a+c.amount,0),l=n+r-t.discount;return{subTotal:n,total:l,POSCharges:e}})},resetPOS:()=>s({POSItems:[],POSCharges:[],subTotal:0,discount:0,total:0,note:"",customer:null,type:"dine_in",paymentType:"cash"})}),{name:"pos-storage",storage:E(()=>localStorage)})),G=(s,i,t)=>{const n=[],e=s==null?void 0:s.filter(o=>o.requirement==="required");return e!=null&&e.length&&e.forEach(o=>{const l=(i==null?void 0:i.map(a=>({id:a.id,option:a.option}))).find(a=>a.id===o.id&&a.option.length!==0);o.allowMultiple&&l&&l.option.length<o.min?(N.error(t("Please select all required variants.")),n.push(t("Please select all required variants."))):l||(N.error(t("Please select all required variants.")),n.push(t("Please select all required variants.")))}),n};export{z as Q,$ as c,L as u,G as v};
