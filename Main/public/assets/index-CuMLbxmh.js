const f=Symbol.for("@ts-pattern/matcher"),P=Symbol.for("@ts-pattern/isVariadic"),E="@ts-pattern/anonymous-select-key",T=e=>!!(e&&typeof e=="object"),x=e=>e&&!!e[f],u=(e,t,n)=>{if(x(e)){const r=e[f](),{matched:i,selections:s}=r.match(t);return i&&s&&Object.keys(s).forEach(a=>n(a,s[a])),i}if(T(e)){if(!T(t))return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;let r=[],i=[],s=[];for(const a of e.keys()){const h=e[a];x(h)&&h[P]?s.push(h):s.length?i.push(h):r.push(h)}if(s.length){if(s.length>1)throw new Error("Pattern error: Using `...P.array(...)` several times in a single pattern is not allowed.");if(t.length<r.length+i.length)return!1;const a=t.slice(0,r.length),h=i.length===0?[]:t.slice(-i.length),S=t.slice(r.length,i.length===0?1/0:-i.length);return r.every((p,O)=>u(p,a[O],n))&&i.every((p,O)=>u(p,h[O],n))&&(s.length===0||u(s[0],S,n))}return e.length===t.length&&e.every((a,h)=>u(a,t[h],n))}return Reflect.ownKeys(e).every(r=>{const i=e[r];return(r in t||x(s=i)&&s[f]().matcherType==="optional")&&u(i,t[r],n);var s})}return Object.is(t,e)},g=e=>{var t,n,r;return T(e)?x(e)?(t=(n=(r=e[f]()).getSelectionKeys)==null?void 0:n.call(r))!=null?t:[]:Array.isArray(e)?j(e,g):j(Object.values(e),g):[]},j=(e,t)=>e.reduce((n,r)=>n.concat(t(r)),[]);function $(...e){if(e.length===1){const[t]=e;return n=>u(t,n,()=>{})}if(e.length===2){const[t,n]=e;return u(t,n,()=>{})}throw new Error(`isMatching wasn't given the right number of arguments: expected 1 or 2, received ${e.length}.`)}function l(e){return Object.assign(e,{optional:()=>N(e),and:t=>c(e,t),or:t=>W(e,t),select:t=>t===void 0?K(e):K(t,e)})}function B(e){return Object.assign((t=>Object.assign(t,{[Symbol.iterator](){let n=0;const r=[{value:Object.assign(t,{[P]:!0}),done:!1},{done:!0,value:void 0}];return{next:()=>{var i;return(i=r[n++])!=null?i:r.at(-1)}}}}))(e),{optional:()=>B(N(e)),select:t=>B(t===void 0?K(e):K(t,e))})}function N(e){return l({[f]:()=>({match:t=>{let n={};const r=(i,s)=>{n[i]=s};return t===void 0?(g(e).forEach(i=>r(i,void 0)),{matched:!0,selections:n}):{matched:u(e,t,r),selections:n}},getSelectionKeys:()=>g(e),matcherType:"optional"})})}const z=(e,t)=>{for(const n of e)if(!t(n))return!1;return!0},L=(e,t)=>{for(const[n,r]of e.entries())if(!t(r,n))return!1;return!0};function c(...e){return l({[f]:()=>({match:t=>{let n={};const r=(i,s)=>{n[i]=s};return{matched:e.every(i=>u(i,t,r)),selections:n}},getSelectionKeys:()=>j(e,g),matcherType:"and"})})}function W(...e){return l({[f]:()=>({match:t=>{let n={};const r=(i,s)=>{n[i]=s};return j(e,g).forEach(i=>r(i,void 0)),{matched:e.some(i=>u(i,t,r)),selections:n}},getSelectionKeys:()=>j(e,g),matcherType:"or"})})}function o(e){return{[f]:()=>({match:t=>({matched:!!e(t)})})}}function K(...e){const t=typeof e[0]=="string"?e[0]:void 0,n=e.length===2?e[1]:typeof e[0]=="string"?void 0:e[0];return l({[f]:()=>({match:r=>{let i={[t??E]:r};return{matched:n===void 0||u(n,r,(s,a)=>{i[s]=a}),selections:i}},getSelectionKeys:()=>[t??E].concat(n===void 0?[]:g(n))})})}function m(e){return typeof e=="number"}function y(e){return typeof e=="string"}function v(e){return typeof e=="bigint"}const _=l(o(function(e){return!0})),M=_,b=e=>Object.assign(l(e),{startsWith:t=>{return b(c(e,(n=t,o(r=>y(r)&&r.startsWith(n)))));var n},endsWith:t=>{return b(c(e,(n=t,o(r=>y(r)&&r.endsWith(n)))));var n},minLength:t=>b(c(e,(n=>o(r=>y(r)&&r.length>=n))(t))),length:t=>b(c(e,(n=>o(r=>y(r)&&r.length===n))(t))),maxLength:t=>b(c(e,(n=>o(r=>y(r)&&r.length<=n))(t))),includes:t=>{return b(c(e,(n=t,o(r=>y(r)&&r.includes(n)))));var n},regex:t=>{return b(c(e,(n=t,o(r=>y(r)&&!!r.match(n)))));var n}}),F=b(o(y)),d=e=>Object.assign(l(e),{between:(t,n)=>d(c(e,((r,i)=>o(s=>m(s)&&r<=s&&i>=s))(t,n))),lt:t=>d(c(e,(n=>o(r=>m(r)&&r<n))(t))),gt:t=>d(c(e,(n=>o(r=>m(r)&&r>n))(t))),lte:t=>d(c(e,(n=>o(r=>m(r)&&r<=n))(t))),gte:t=>d(c(e,(n=>o(r=>m(r)&&r>=n))(t))),int:()=>d(c(e,o(t=>m(t)&&Number.isInteger(t)))),finite:()=>d(c(e,o(t=>m(t)&&Number.isFinite(t)))),positive:()=>d(c(e,o(t=>m(t)&&t>0))),negative:()=>d(c(e,o(t=>m(t)&&t<0)))}),I=d(o(m)),w=e=>Object.assign(l(e),{between:(t,n)=>w(c(e,((r,i)=>o(s=>v(s)&&r<=s&&i>=s))(t,n))),lt:t=>w(c(e,(n=>o(r=>v(r)&&r<n))(t))),gt:t=>w(c(e,(n=>o(r=>v(r)&&r>n))(t))),lte:t=>w(c(e,(n=>o(r=>v(r)&&r<=n))(t))),gte:t=>w(c(e,(n=>o(r=>v(r)&&r>=n))(t))),positive:()=>w(c(e,o(t=>v(t)&&t>0))),negative:()=>w(c(e,o(t=>v(t)&&t<0)))}),J=w(o(v)),R=l(o(function(e){return typeof e=="boolean"})),U=l(o(function(e){return typeof e=="symbol"})),V=l(o(function(e){return e==null})),q=l(o(function(e){return e!=null}));var D={__proto__:null,matcher:f,optional:N,array:function(...e){return B({[f]:()=>({match:t=>{if(!Array.isArray(t))return{matched:!1};if(e.length===0)return{matched:!0};const n=e[0];let r={};if(t.length===0)return g(n).forEach(s=>{r[s]=[]}),{matched:!0,selections:r};const i=(s,a)=>{r[s]=(r[s]||[]).concat([a])};return{matched:t.every(s=>u(n,s,i)),selections:r}},getSelectionKeys:()=>e.length===0?[]:g(e[0])})})},set:function(...e){return l({[f]:()=>({match:t=>{if(!(t instanceof Set))return{matched:!1};let n={};if(t.size===0)return{matched:!0,selections:n};if(e.length===0)return{matched:!0};const r=(s,a)=>{n[s]=(n[s]||[]).concat([a])},i=e[0];return{matched:z(t,s=>u(i,s,r)),selections:n}},getSelectionKeys:()=>e.length===0?[]:g(e[0])})})},map:function(...e){return l({[f]:()=>({match:t=>{if(!(t instanceof Map))return{matched:!1};let n={};if(t.size===0)return{matched:!0,selections:n};const r=(h,S)=>{n[h]=(n[h]||[]).concat([S])};if(e.length===0)return{matched:!0};var i;if(e.length===1)throw new Error(`\`P.map\` wasn't given enough arguments. Expected (key, value), received ${(i=e[0])==null?void 0:i.toString()}`);const[s,a]=e;return{matched:L(t,(h,S)=>{const p=u(s,S,r),O=u(a,h,r);return p&&O}),selections:n}},getSelectionKeys:()=>e.length===0?[]:[...g(e[0]),...g(e[1])]})})},intersection:c,union:W,not:function(e){return l({[f]:()=>({match:t=>({matched:!u(e,t,()=>{})}),getSelectionKeys:()=>[],matcherType:"not"})})},when:o,select:K,any:_,_:M,string:F,number:I,bigint:J,boolean:R,symbol:U,nullish:V,nonNullable:q,instanceOf:function(e){return l(o(function(t){return n=>n instanceof t}(e)))},shape:function(e){return l(o($(e)))}};class C extends Error{constructor(t){let n;try{n=JSON.stringify(t)}catch{n=t}super(`Pattern matching error: no pattern matches value ${n}`),this.input=void 0,this.input=t}}const k={matched:!1,value:void 0};function G(e){return new A(e,k)}class A{constructor(t,n){this.input=void 0,this.state=void 0,this.input=t,this.state=n}with(...t){if(this.state.matched)return this;const n=t[t.length-1],r=[t[0]];let i;t.length===3&&typeof t[1]=="function"?i=t[1]:t.length>2&&r.push(...t.slice(1,t.length-1));let s=!1,a={};const h=(p,O)=>{s=!0,a[p]=O},S=!r.some(p=>u(p,this.input,h))||i&&!i(this.input)?k:{matched:!0,value:n(s?E in a?a[E]:a:this.input,this.input)};return new A(this.input,S)}when(t,n){if(this.state.matched)return this;const r=!!t(this.input);return new A(this.input,r?{matched:!0,value:n(this.input,this.input)}:k)}otherwise(t){return this.state.matched?this.state.value:t(this.input)}exhaustive(){if(this.state.matched)return this.state.value;throw new C(this.input)}run(){return this.exhaustive()}returnType(){return this}}export{D as N,G as z};
