import{r as g,u as w,f as I,j as e,I as M,S as T,b as y,t as b}from"./app-DV9Enp-g.js";import{c as B}from"./currency_formatter-Bz1CGAdC.js";import{O as k}from"./order_status-CM2aeLIm.js";import{s as L}from"./string_formatter-C0BoQtKC.js";import{u as D}from"./useTranslation-B_tqir3M.js";import{H as h,B as A}from"./platform_roles-C6HFwJ_S.js";import{T as z,U as _}from"./User-nTP7YzRg.js";import{M as O,a as V,A as C,b as U,T as E,c as S}from"./ArrowDown2-BYk1CnSd.js";import{B as P}from"./_rollupPluginBabelHelpers-3bc641ae-fORsOdMW.js";import{B as H}from"./input-BY0aN3Wh.js";import{f as R}from"./format-DNgEHVKA.js";function W({type:c,status:s,deliveryPerson:o,orderId:r,refresh:i}){const{t:d}=D(),[u,N]=g.useState(!1),{data:t,isLoading:x}=w(()=>c==="delivery"&&"/api/users?type=delivery",I),f=async a=>{var l;N(!0);try{const{data:m}=await y.patch(`/api/orders/${r}`,{deliveryManId:a});(l=m==null?void 0:m.content)!=null&&l.id&&(b.success(d("Delivery person updated successfully")),i==null||i())}catch(m){b.error(d(m.response.data.message||"Something went wrong"))}finally{N(!1)}};return s==="pending"?null:s!=="processing"&&s!=="ready"?e.jsxDEV("div",{className:"flex-1 font-normal text-left border py-2 px-3 rounded-md border-secondary-200 bg-secondary-50",children:e.jsxDEV(h,{children:[e.jsxDEV(M,{as:s==="on_delivery"?z:_,size:"sm"},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:73,columnNumber:11},this),e.jsxDEV("span",{children:o==null?void 0:o.fullName},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:74,columnNumber:11},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:72,columnNumber:9},this)},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:71,columnNumber:7},this):e.jsxDEV(O,{matchWidth:!0,children:[e.jsxDEV(h,{className:"flex-1 w-full gap-0",children:[e.jsxDEV(V,{as:P,variant:"outline",className:"flex-1 rounded-r-none",onClick:a=>a.stopPropagation(),children:e.jsxDEV("div",{className:"flex-1 text-left",children:u?e.jsxDEV("span",{className:"text-secondary-400",children:[" ",d("Loading...")," "]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:91,columnNumber:15},this):(o==null?void 0:o.fullName)||e.jsxDEV("span",{className:"text-secondary-400 font-normal",children:d("Select delivery person")},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:94,columnNumber:17},this)},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:89,columnNumber:11},this)},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:83,columnNumber:9},this),e.jsxDEV("div",{className:"border border-secondary-200 bg-secondary-100 h-10 text-secondary-400 w-10 p-0 flex items-center justify-center rounded-r-md",children:e.jsxDEV(C,{size:16},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:102,columnNumber:11},this)},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:101,columnNumber:9},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:82,columnNumber:7},this),e.jsxDEV(U,{className:"p-1",children:x?e.jsxDEV(h,{justifyContent:"center",py:"2.5",children:[e.jsxDEV(T,{size:"sm"},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:109,columnNumber:13},this),e.jsxDEV(E,{className:"text-secondary-500",children:[" ",d("Loading...")," "]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:110,columnNumber:13},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:108,columnNumber:11},this):(t==null?void 0:t.length)===0?e.jsxDEV(E,{children:d("Delivery person isn't available")},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:113,columnNumber:11},this):t==null?void 0:t.map(a=>e.jsxDEV(S,{onClick:l=>{l.stopPropagation(),f(a.id)},children:d(a.fullName)},a.id,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:116,columnNumber:13},this))},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:106,columnNumber:7},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/UpdateDeliveryPerson.tsx",lineNumber:81,columnNumber:5},this)}const j=new k;function ie({onClick:c,data:s,refresh:o}){const{t:r}=D(),[i,d]=g.useState(()=>j.getStatusDetails(s.status||"pending"));if(g.useEffect(()=>{d(j.getStatusDetails(s.status))},[s]),!s)return;const{id:u,orderNumber:N,type:t,grandTotal:x,orderItems:f,paymentStatus:a,createdAt:l}=s,m=async n=>{var v;if(!s.deliveryManId&&s.type==="delivery"&&(n.value==="on_delivery"||n.value==="completed")){b.error(r("Select delivery person first"));return}try{const{data:p}=await y.patch(`/api/orders/${u}`,{status:n.value});(v=p==null?void 0:p.content)!=null&&v.id&&(b.success(r("Order updated successfully")),o())}catch(p){b.error(r(p.response.data.message||"Something went wrong"))}};return e.jsxDEV(H,{onClick:()=>c==null?void 0:c(u),className:"h-56 flex flex-col justify-between bg-white shadow-primary rounded-md p-4 cursor-pointer",children:[e.jsxDEV("div",{className:"flex items-start justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV(A,{colorScheme:{dine_in:"cyan",delivery:"primary",pickup:"blue"}[t],mb:1,children:r(L(t))},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:87,columnNumber:11},this),e.jsxDEV("p",{className:"text-secondary-600 font-bold mb-1",children:["#",N]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:93,columnNumber:11},this),e.jsxDEV("p",{className:"text-secondary-400 text-sm",children:R(new Date(l),"MMM dd, yyyy | hh:mm a")},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:94,columnNumber:11},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:86,columnNumber:9},this),e.jsxDEV("div",{className:"flex flex-col items-end",children:[e.jsxDEV(A,{colorScheme:a?"green":"orange",mb:1,children:r(a?"Paid":"Unpaid")},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:99,columnNumber:11},this),e.jsxDEV("p",{className:"text-secondary-600 font-bold mb-1",children:B(x)},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:102,columnNumber:11},this),e.jsxDEV("p",{className:"text-secondary-400 text-sm",children:[f.length," ",f.length>1?r("Item(s)"):r("Item")]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:103,columnNumber:11},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:98,columnNumber:9},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:85,columnNumber:7},this),e.jsxDEV("div",{className:"flex flex-col gap-2",children:[i.value!=="pending"&&t==="delivery"?e.jsxDEV("div",{className:"flex items-center gap-4",children:e.jsxDEV(W,{type:t,status:s.status,orderId:u,deliveryPerson:s.deliveryMan,refresh:o},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:112,columnNumber:13},this)},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:111,columnNumber:11},this):null,e.jsxDEV(O,{children:[e.jsxDEV(V,{as:P,w:"full",variant:"outline",textAlign:"left",colorScheme:i==null?void 0:i.scheme,color:i==null?void 0:i.fgColor,borderColor:i==null?void 0:i.fgColor,rightIcon:e.jsxDEV(C,{},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:130,columnNumber:24},this),onClick:n=>n.stopPropagation(),children:r(i==null?void 0:i.label)},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:122,columnNumber:11},this),e.jsxDEV(U,{className:"p-1",children:j.all().map(n=>(!n.orderType||n.orderType===t)&&e.jsxDEV(S,{color:n.fgColor,onClick:v=>{v.stopPropagation(),m(n)},children:r(n.label)},n.value,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:139,columnNumber:19},this))},void 0,!1,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:135,columnNumber:11},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:121,columnNumber:9},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:109,columnNumber:7},this)]},void 0,!0,{fileName:"E:/abid/getpasto-adonisjs6/inertia/components/Admin/ActiveOrders/OrderCard.tsx",lineNumber:81,columnNumber:5},this)}export{ie as O,W as U};
